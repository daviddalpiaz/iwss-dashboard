---
title: "Illinois Wastewater Surveillance System"
author: "Urbana-Champaign Sanitary District Northeast Sewage Treatment Plant"
format: dashboard
---

```{python}
import pandas as pd
from datetime import datetime
from matplotlib import pyplot as plt
from IPython.display import Markdown
from statsmodels.nonparametric.smoothers_lowess import lowess
from helpers import process_data, plot_data
```

```{python}
url = "https://iwss.uillinois.edu/wastewater-treatment-plant/download/159/"
df = pd.read_csv(url)
```

```{python}
df = process_data(df)
```

## Row

```{python}
#| content: valuebox
#| title: "Most Recent Collection"

dict(
    color = "secondary",
    value = df.iloc[-1, 0].date().strftime('%Y-%m-%d')
)
```

```{python}
#| content: valuebox
#| title: "Most Recent Concentration (gc/L)"

dict(
  icon = "virus",
  color = "primary",
  value = df.iloc[-1, 1]
)
```

## Row

The data presented in this dashboard are generated by the [Illinois Wastewater Surveillance System](https://iwss.uillinois.edu/). This data is specific to the [Urbana-Champaign Sanitary District Northeast Sewage Treatment Plant](https://iwss.uillinois.edu/wastewater-treatment-plant/159/?target=SARS-CoV-2).

For more information about the data, please see the IWSS [About the Data](https://iwss.uillinois.edu/about/data-readme/) page.


## Row {height="40%"}

```{python}
#| title: SARS-CoV-2 Wastewater Measurements (Plot)
#| expandable: false
plot_data(df)
```

## Row {height="40%"}

```{python}
#| title: SARS-CoV-2 Wastewater Measurements (Table)
#| expandable: false
df['sample_collect_date'] = pd.to_datetime(df['sample_collect_date']).dt.date
df = df.rename(columns={"sample_collect_date": "Collection Date", "sars_cov_2": "Gene Copies per Liter"})
Markdown(df.to_markdown(index=False))
```
